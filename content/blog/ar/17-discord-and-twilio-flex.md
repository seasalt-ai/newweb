---
title: "ديسكورد (3/3): ديسكورد وتويليو فليكس: جلب مركز اتصال فليكس إلى منطقة مجهولة"
metatitle: "ديسكورد (3/3): مركز اتصال تويليو فليكس في ديسكورد"
date: 2022-06-07T12:32:24-07:00
author: Kim Dodds
draft: false
image: /images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/flex-discord-thumbnail.png
description: "في هذه المدونة، سنوضح كيفية دمج Seasalt.ai لمركز اتصال متكامل في خادم ديسكورد."
weight: 1
tags: ["SeaX", "Discord"]
canonicalURL: "/blog/discord-and-twilio"
url: "/blog/discord-and-twilio/"
aliases:
  - /blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/
modified_date: "2025-07-28T16:56:53Z"
---

*هذا هو آخر منشور لنا في سلسلة من ثلاثة أجزاء حول تفاعل العملاء على ديسكورد. ناقشت مدونتنا الأولى، ["حدود جديدة لتفاعل العملاء"](https://seasalt.ai/blog/15-discord-a-new-frontier-for-customer-engagement/)، ارتفاع شعبية ديسكورد، والفرصة الجديدة التي يمثلها للعلامات التجارية لإنشاء مجتمعاتها الخاصة عبر الإنترنت والمشاركة فيها. في الجزء الثاني، ["كيفية إنشاء مجتمع ديسكورد وروبوت لعلامتك التجارية"](https://seasalt.ai/blog/16-discord-how-to-create-a-discord-community-and-bot-for-your-brand/)، شرحنا كيفية إنشاء خادم ديسكورد لعلامتك التجارية، وكيفية دمج روبوت لإدارة الإشراف على الخادم والإعلانات وملاحظات المستخدمين وما إلى ذلك. أخيرًا، في هذه المدونة، سنقدم عرضًا توضيحيًا لكيفية دمجنا في Seasalt.ai لمركز اتصال متكامل في خادم ديسكورد، مما يسمح للعلامات التجارية بالتعامل مع جميع جوانب خدمة العملاء على المنصة.*

## جدول المحتويات
- [جدول المحتويات](#table-of-contents)
- [عرض توضيحي لخدمة عملاء ديسكورد](#discord-customer-service-demo)
- [تويليو فليكس](#twilio-flex)
- [SeaX](#seax)
- [خادم العرض التوضيحي](#demo-server)
  - [مساعدة 1 إلى متعدد: القنوات الرسمية](#1-to-many-help-official-channels)
  - [مساعدة 1 إلى 1: وكيل خدمة العملاء](#1-to-1-help-customer-service-agent)
    - [قاعدة المعرفة](#knowledge-base)
    - [تحويل وكيل مباشر](#live-agent-transfer)
  - [إدارة الحالات](#case-management)
- [الغوص الفني العميق](#technical-deep-dive)
  - [تحديد تدفق فليكس](#define-the-flex-flow)
  - [إنشاء قناة مخصصة](#create-a-custom-channel)
  - [إنشاء خادم HTTP لدعم التوجيه الأكثر تعقيدًا](#create-an-http-server-to-support-more-complex-routing)
    - [خطاف ويب للرسائل الصادرة](#outbound-messages-webhook)
    - [تكامل الروبوت](#bot-integration)
- [ملخص](#summary)

# عرض توضيحي لخدمة عملاء ديسكورد
إذا كنت حريصًا على الوصول إلى الهدف ورؤية المنتج النهائي، فسنقدم الفيديو التوضيحي النهائي أولاً:

<iframe width="85%" height="450px" src="https://www.youtube.com/embed/iUK4YkGYI6Q" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="border-radius: 30px;"></iframe>


هدفنا هو إظهار كيفية دمج ديسكورد في برامج خدمة العملاء الحالية (في هذه الحالة، [تويليو فليكس](https://flex.twilio.com/)) لإضافة قيمة إضافية إلى الخادم الرسمي للعلامة التجارية. استمر في القراءة لإلقاء نظرة فاحصة على تنفيذنا.

# تويليو فليكس
تويليو هي شركة اتصالات راسخة تقدم واجهات برمجة تطبيقات لإدارة الرسائل النصية والمكالمات الهاتفية ورسائل البريد الإلكتروني ورسائل الدردشة والمزيد. فليكس هو أحد منتجات تويليو الرئيسية: مركز اتصال قائم على السحابة قابل للتطوير يوجه الرسائل والمكالمات من أي مصدر إلى وكلاء افتراضيين ومباشرين. لقد اخترنا فليكس كأساس لتكامل مركز الاتصال الخاص بنا لأنه يدعم بالفعل مجموعة واسعة من القنوات، مثل فيسبوك والرسائل القصيرة وواتساب.

# SeaX
SeaX هو مركز اتصال سحابي متكامل بعمق مع ميزات الذكاء الاصطناعي المتقدمة التي تساعد على زيادة الإنتاجية ورضا العملاء. SeaX هو أحد منتجات Seasalt.ai الرئيسية، وقد تم طرحه بالفعل للعملاء في أكثر من 150 دولة. تم بناء منصة مركز اتصال SeaX فوق تويليو فليكس وتتضمن مجموعة متنوعة من الميزات الإضافية التي تمكن الوكلاء المباشرين من مساعدة العملاء بشكل أفضل. بعض الميزات الأكثر فائدة هي تحويل النص إلى كلام والكلام إلى نص داخل الشركة، وقاعدة المعرفة التي تعمل بالذكاء الاصطناعي، ونظام إدارة الحالات المتكامل. لمزيد من المعلومات حول جميع إمكانيات منصة SeaX، يرجى زيارة [الصفحة الرئيسية لـ SeaX](https://seax.seasalt.ai/?utm_source=blog/).

# خادم العرض التوضيحي
الآن سنشرح كيفية إعداد خادم ديسكورد الخاص بنا. لأغراض العرض التوضيحي، تخيلنا سيناريو حيث تم استخدام خادمنا كمجتمع للعبة مثل Pokémon Go! يوضح الجدول التالي بعض الميزات التي تم عرضها في خادم ديسكورد الخاص بنا.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-demo-features-2.png" alt="نظرة عامة على ميزات خادم ديسكورد لخدمة العملاء التجريبي."/>

*نظرة عامة على ميزات خادم ديسكورد التجريبي.*
</center>

## مساعدة 1 إلى متعدد: القنوات الرسمية
تم إعداد العديد من القنوات في الخادم لتوفير بث مباشر بين المسؤولين/المطورين الرسميين واللاعبين.
يمكن للمسؤولين والمشرفين فقط النشر في **قناة الإعلانات**، ويمكن أن تتضمن منشورات (يدوية أو آلية) من حساب تويتر أو موقع الويب أو مصادر رسمية أخرى.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-demo-announcement-channel.jpg" alt="قناة الإعلانات على خادم ديسكورد، والتي تعرض منشورًا من حساب تويتر رسمي."/>

*قناة #announcements على خادم ديسكورد التجريبي.*
</center>

تسمح **قناة الإبلاغ عن الأخطاء** للاعبين بمناقشة الأخطاء والمشكلات التي تعطل اللعبة. يمكن للمسؤولين مراقبة هذه القناة لتحديد أي مشكلات في اللعبة يجب استهدافها. بالإضافة إلى ذلك، يمكن للمستخدمين إرسال تقرير خطأ رسمي باستخدام أمر الشرطة المائلة `/bug` من داخل القناة.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-demo-bug-report-channel.jpg" alt="قناة الإبلاغ عن الأخطاء على خادم ديسكورد، والتي تعرض تقرير خطأ تم إرساله."/>

*قناة #bug-report على خادم ديسكورد التجريبي، والتي تعرض تقرير خطأ تم إرساله.*
</center>

تسمح **قناة طلب الميزات** للاعبين بمناقشة تغييرات طريقة اللعب وتحسينات جودة الحياة وإضافات المحتوى وما إلى ذلك التي يرغبون في رؤيتها مضافة إلى اللعبة. على غرار قناة طلب الأخطاء، يمكن لمشرفي ديسكورد رؤية مدخلاتهم ويمكنهم استخدام أمر الشرطة المائلة `/new_feature` لإرسال طلب رسمي.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-demo-feature-request-channel.jpg" alt="قناة طلب الميزات على خادم ديسكورد، والتي تعرض مستخدمًا يقوم بتنفيذ أمر شرطة مائلة."/>

*قناة #feature-request على خادم ديسكورد التجريبي، والتي تعرض مستخدمًا يقوم بتنفيذ أمر شرطة مائلة.*
</center>

## مساعدة 1 إلى 1: وكيل خدمة العملاء

يمكن للاعبين استخدام أمر الشرطة المائلة `/helpme` لتشغيل رسالة مباشرة مع وكيل. يمكن أن يكون وكيل خدمة العملاء آليًا (وكيل افتراضي) أو يديره وكيل مباشر.

بالنسبة للعرض التوضيحي الخاص بنا، قمنا بإعداد روبوت أسئلة وأجوبة بسيط يستعلم عن قاعدة معارف الشركة لتقديم اقتراحات مقالات ذات صلة للمستخدم. يمكن للمستخدم أيضًا طلب وكيل مباشر، وسيتم تحويله في نفس الدردشة إلى وكيل مباشر على SeaX.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-demo-customer-service-channel.jpg" alt="قناة خدمة العملاء على خادم ديسكورد، والتي تعرض مستخدمًا يقوم بتشغيل رسالة مباشرة."/>

*قناة #feature-request على خادم ديسكورد التجريبي، والتي تعرض مستخدمًا يقوم بتشغيل رسالة مباشرة.*
</center>

### قاعدة المعرفة
عندما يرسل المستخدم استعلامًا إلى وكيل الخدمة الافتراضي، يمكن للوكيل إحالة المستخدم إلى المقالات ذات الصلة في قاعدة المعرفة.

### تحويل وكيل مباشر
بمجرد أن يكون المستخدم في رسالة مباشرة مع الروبوت، يمكنه طلب وكيل مباشر. سيتم إعلامهم على الفور بأنه تم إنشاء حالة لهم، وأنه يتم تحويلهم إلى وكيل مباشر. عندما ينضم الوكيل المباشر إلى الدردشة، سيتلقون أيضًا إشعارًا.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-demo-customer-service-dm.jpg" alt="رسالة مباشرة مع خدمة العملاء، تعرض اقتراحات مقالات قاعدة المعرفة، وتحويل وكيل مباشر، وإدارة الحالات."/>

*رسالة مباشرة مع خدمة العملاء، تعرض اقتراحات مقالات قاعدة المعرفة، وتحويل وكيل مباشر، وإدارة الحالات.*
</center>

على الواجهة الخلفية، يمكن للوكلاء المباشرين التعامل مع المكالمات الواردة ورسائل الدردشة من جميع القنوات (الرسائل القصيرة، فيسبوك، ديسكورد، المكالمات الصوتية، إلخ) من خلال منصة واحدة. في هذه الحالة، المنصة الخلفية هي SeaX.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/flex-discord-channel.jpg" alt="واجهة SeaX تعرض عرض الوكيل المباشر لمحادثة مع مستخدم على ديسكورد."/>

*واجهة SeaX تعرض عرض الوكيل المباشر لمحادثة مع مستخدم على ديسكورد.*
</center>

## إدارة الحالات
إحدى الميزات التي أردنا التأكيد عليها في هذا العرض التوضيحي هي إدارة الحالات. يتكامل حل ديسكورد من Seasalt.ai مع نظام إدارة حالات SeaX لتتبع الحالات المختلفة من المستخدمين بشكل صحيح. عندما يتفاعل المستخدم مع روبوت ديسكورد (مثل طلب وكيل مباشر أو الإبلاغ عن خطأ)، يمكننا فتح حالة جديدة تلقائيًا وتسجيل جميع المعلومات المهمة حول المستخدم والمشكلة التي يواجهونها. يتيح ذلك للوكيل المباشر الوصول بسهولة إلى جميع المشكلات المبلغ عنها، والتأكد من متابعتهم مع المستخدمين حتى يتم حل الحالة.

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-new-case.png" alt="إنشاء حالة جديدة في نظام إدارة حالات SeaX."/>

*إنشاء حالة جديدة في نظام إدارة حالات SeaX.*

<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-existing-case.png" alt="عرض حالة موجودة في نظام إدارة حالات SeaX."/>

*عرض حالة موجودة في نظام إدارة حالات SeaX.*

</center>

# الغوص الفني العميق

الآن لقد رأينا المنتج النهائي وجميع الميزات المتاحة لأعضاء الخادم والوكلاء المباشرين الذين يساعدونهم. ولكن كيف تم تنفيذ كل شيء بالفعل؟ في منشور المدونة الأخير الخاص بنا، "[كيفية إنشاء مجتمع ديسكورد وروبوت لعلامتك التجارية](https://seasalt.ai/blog/16-discord-how-to-create-a-discord-community-and-bot-for-your-brand/)"، شرحنا كيفية إنشاء خادم ديسكورد لعلامتك التجارية وكيفية دمج روبوت ديسكورد لإدارته. لدعم هذا العرض التوضيحي الأكثر تقدمًا، استخدمنا أيضًا [SeaChat، محرك الذكاء الاصطناعي للمحادثة من Seasalt.ai](https://chat.seasalt.ai)، لبناء روبوت محادثة بسيط يسمح لروبوت ديسكورد الخاص بنا بالتعامل مع استعلامات اللغة الطبيعية للمستخدمين.

على جانب SeaX، عمل فريقنا بشكل وثيق مع تويليو لإنشاء حل مركز اتصال مليء بالميزات مبني على تويليو فليكس. لمزيد من المعلومات حول تويليو فليكس وكيفية عمل عملية الإعداد، يمكنك قراءة [دليل البدء السريع لتويليو فليكس](https://www.twilio.com/docs/flex/quickstart).

بعد إعداد خادم ديسكورد وروبوت ديسكورد وروبوت المحادثة والتأكد من أن لدينا مثيلًا عاملاً من SeaX قيد التشغيل، فإن التحدي الأكبر هو توجيه الرسائل بشكل صحيح من وإلى المستخدم والروبوت والوكلاء المباشرين على SeaX. تويليو رائعة في التعامل مع توجيه الرسائل، لذا فإن هدفنا هو التعامل مع جميع أوامر الشرطة المائلة من داخل خادم روبوت ديسكورد الخاص بنا، ثم إعادة توجيه جميع الرسائل الأخرى (مثل الرسائل المباشرة إلى روبوت المحادثة أو الوكيل المباشر) إلى تويليو.

## تحديد تدفق فليكس
الخطوة الأولى هي التأكد من أن أي رسائل نرسلها إلى تويليو سيتم توجيهها إلى المكان الصحيح. لقد قمنا بإعداد تدفق تويليو بسيط يتحقق أولاً مما إذا كان المستخدم قد طلب وكيلًا مباشرًا، وإذا كان الأمر كذلك، فإنه يعيد توجيه الرسائل التالية إلى SeaX. إذا لم يطلب المستخدم وكيلًا مباشرًا، فإننا نعيد توجيه الرسالة إلى روبوت المحادثة للحصول على رد. لمزيد من المعلومات حول كيفية إعداد التدفق، راجع [وثائق تدفق استوديو تويليو](https://www.twilio.com/docs/studio).

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-flow.png" alt="تدفق استوديو فليكس بسيط يوجه الرسائل الواردة إلى روبوت محادثة أو إلى SeaX."/>

*تدفق استوديو فليكس بسيط يوجه الرسائل الواردة إلى روبوت محادثة أو إلى SeaX.*
</center>

## إنشاء قناة مخصصة
لذا لدينا الآن فكرة عن كيفية توجيه الرسائل الواردة. ومع ذلك، فإن ديسكورد ليست قناة مدعومة أصلاً من قبل تويليو. لحسن الحظ، لدى تويليو برنامج تعليمي مفصل حول كيفية [إضافة قناة دردشة مخصصة إلى تويليو فليكس](https://www.twilio.com/blog/add-custom-chat-channel-twilio-flex). بعد اتباع الدليل لإعداد القناة المخصصة الجديدة على تويليو، نحتاج فعليًا إلى إعادة توجيه الرسائل من ديسكورد إلى تويليو.

أولاً نقوم بإعداد عميل تويليو:

```python
from twilio.rest import Client
twilio_client = Client(TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN)
```

الآن، بمجرد أن نتلقى رسالة واردة من ديسكورد، يمكننا إعادة توجيه تلك الرسالة إلى تويليو عبر عميل تويليو. أولاً، يجب أن نتحقق مما إذا كان المستخدم موجودًا بالفعل في نظام تويليو، وما إذا كان لديه قناة دردشة مفتوحة بالفعل.

```python
# استدعاء طريقة get_user للتحقق مما إذا كان المستخدم موجودًا، وإنشاء مستخدم جديد إذا لم يكن كذلك
user = await get_user(user_id, twilio_client, TWILIO_SERVICE_SID)

# جلب القنوات التي يتواجد فيها المستخدم
user_channels = twilio_client.chat \
        .services(TWILIO_SERVICE_SID) \
        .users(user_id) \
        .user_channels \
        .list()
```

إذا كان لدى المستخدم قناة دردشة مفتوحة حالية، فنحن بحاجة إلى استخدامها حتى نتمكن من الوصول إلى سجل الدردشة. إذا لم تكن هناك قناة دردشة حالية، فإننا ننشئ قناة جديدة للمستخدم:

```python
if user_channels:
    channel_sid = user_channels[-1].channel_sid
else:
    channel = twilio_client.flex_api \
            .channel \
            .create(
                flex_flow_sid=FLEX_FLOW_ID,
                chat_user_friendly_name=username,
                chat_friendly_name=chat_name,  # -> الاسم المألوف لقناة الدردشة
                target=conversation_id,  # -> الهوية التي تحدد مستخدم الدردشة بشكل فريد
                identity=conversation_id,  # -> المستخدم، على سبيل المثال/ معرف الرسائل المباشرة في ديسكورد
        )
    channel_sid = channel.sid
```

أخيرًا، بمجرد أن يكون لدينا قناة دردشة مفتوحة بين مستخدم ديسكورد وتويليو، يمكننا إعادة توجيه الرسالة الواردة إلى تدفق استوديو تويليو.

```python
message = twilio_client.chat \
        .services(TWILIO_SERVICE_SID) \
        .channels(channel_sid) \
        .messages \
        .create(
            body=message_text,
            from_=user_id,
            x_twilio_webhook_enabled='true',
            attributes=json.dumps(message_json)  # إرسال الرؤوس كسمة بحيث يمكن الوصول إليها لاحقًا
        )
```
الآن لدينا القدرة على إعادة توجيه جميع رسائلنا الواردة من مستخدمي ديسكورد مباشرة إلى تدفق تويليو فليكس الخاص بنا. على جانب روبوت ديسكورد، تأكد من إعادة توجيه جميع الرسائل المباشرة إلى تويليو. الآن يمكنك محاولة إرسال رسالة مباشرة إلى روبوت ديسكورد، ويجب أن تراها تظهر في سجلات تدفق استوديو تويليو - لم ننته بعد!

## إنشاء خادم HTTP لدعم التوجيه الأكثر تعقيدًا

### خطاف ويب للرسائل الصادرة
لذا لدينا الآن فكرة عن كيفية توجيه رسائلنا الواردة. ومع ذلك، ما زلنا نفتقد بعض القطع. أولاً وقبل كل شيء، نعلم أنه يمكننا الآن إيصال الرسائل إلى تويليو، ولكن كيف نرد على مستخدمينا على ديسكورد؟ روبوت ديسكورد الخاص بنا هو الشيء الوحيد المصرح له بإرسال رسائل إلى خادم ديسكورد والمستخدمين، ولا يعرف تويليو كيفية إعادة رسائلنا إلى خادم ديسكورد على أي حال. الحل هو أننا بحاجة إلى إعداد خطاف ويب للرسائل الصادرة سيتم تشغيله في كل مرة توجد فيها رسالة جديدة في قناة دردشة تويليو. ضمن خطاف الويب هذا، يمكننا بعد ذلك استخدام روبوت ديسكورد الخاص بنا لإعادة توجيه الرسالة مرة أخرى إلى خادمنا.

للقيام بذلك، نقوم بدمج روبوت ديسكورد الخاص بنا في خادم HTTP أكثر قوة. لقد استخدمنا [FastAPI](https://fastapi.tiangolo.com/) لإعداد نقطة نهاية POST بسيطة ستعمل كخطاف ويب للرسائل الصادرة. بمجرد إعداد الخادم وتشغيل روبوت ديسكورد الخاص بنا بجانبه، يمكننا تحديد نقطة نهاية POST.

ستتلقى نقطة النهاية هذه كل رسالة فردية تتم إضافتها إلى قناة الدردشة، لذا نريد أولاً تصفية كل شيء باستثناء الرسائل الصادرة من SeaX. بعد ذلك، سنحتاج إلى الحصول على معرف القناة الصحيح من نص الرسالة حتى نعرف إلى أين نوجه الرسالة. أخيرًا، يمكننا استخدام عميل ديسكورد لإعادة توجيه الرسالة إلى قناة ديسكورد.

```python
@app.post("/forward-to-discord", status_code=200)
async def forward_discord_message(request: Request, response: Response) -> None:
    raw_body = await request.body()
    body = urllib.parse.parse_qs(raw_body.decode())

    # انتبه فقط للرسائل من SDK (Flex، ستكون جميع الرسائل الأخرى من API)
    if not body.get('Source') == ['SDK']:
        return

    # لا تحتوي الرسائل من Flex على معرف المحادثة الأصلي للرسالة
    # نحتاج إلى معرف المحادثة لإرسال الرسالة مرة أخرى إلى المحادثة على GBM
    # جلب الرسالة السابقة واستخراج معرف المحادثة
    message = twilio_client.chat \
            .services(TWILIO_SERVICE_SID) \
            .channels(body.get("ChannelSid")[0]) \
            .messages.list(limit=1)[0]

    attributes = json.loads(message.attributes)

    channel = discord_client.get_channel(attributes.get(“channel”, {}).get(“id”))
    if channel:
        await channel.send(body.get("Body", [""])[0].get(“text”))
    else:
        logger.error(f"لم يتم العثور على قناة ديسكورد بالمعرف: {get_channel_id(req)}!")
        response.status_code = 400
```

أخيرًا، لكي يتم إرسال الرسائل إلى نقطة النهاية الخاصة بنا، نحتاج إلى إعلام تويليو بخطاف الويب الجديد الخاص بنا. يجب أن يكون لكل قناة دردشة خطاف ويب خاص بها مهيأ. لذا، إذا عدنا إلى حيث أنشأنا في الأصل قناة الدردشة الجديدة للمستخدم، فيمكننا إضافة بعض التعليمات البرمجية الإضافية لتهيئة خطاف الويب:

```python
webhook = twilio_client.chat \
        .services(TWILIO_SERVICE_SID) \
        .channels(channel_sid) \
        .webhooks \
        .create(
            type='webhook',   
configuration_url=f"{SERVER_HOST}/forward-to-discord",
            configuration_method="POST",
            configuration_filters=["onMessageSent", "onMessageUpdated", "onMediaMessageSent"]
        )
```

### تكامل الروبوت

لذا يجب الآن توجيه الرسائل الصادرة من SeaX بشكل صحيح مرة أخرى إلى خادم ديسكورد الخاص بنا. لكننا ما زلنا لم نعالج الرسائل التي تذهب إلى روبوت المحادثة. نحتاج إلى إعداد نقطة نهاية أخيرة سيتم تشغيلها من تدفق استوديو تويليو وستتلقى رسالة المستخدم، وتستعلم عن الروبوت، وتعيد الرد إلى ديسكورد.

```python
@app.post("/chatbot-to-discord", status_code=200)
async def receive_discord_message(request: Request, response: Response):
    """تلقي طلب POST من تويليو، والاستعلام عن الروبوت، وإعادة الرد إلى ديسكورد."""
    req = await request.body()
    # فصل نص الرسالة الأصلي عن محتوى تويليو
    twilio_body, original_message_body = separate_original_message_body(req.decode())

    bot_response = await query_bot(original_message_body, bot_info)

    if bot_response:
        channel = discord_client.get_channel(original_message_body.get(“channel_id”))
        if channel:
            for item in bot_response:
                await channel.send(item.get(“text”))
```

تأكد من أن تدفق استوديو تويليو لديه خطاف الويب الصحيح لتوجيه الرسائل إلى الروبوت. الآن لقد انتهينا من توجيه الرسائل لدينا! يمكننا رؤية عرض عالي المستوى لجميع توجيهات الرسائل في هذا الرسم التخطيطي:

<center>
<img src="/images/blog/17-discord-and-twilio-flex-bringing-flex-contact-center-into-uncharted-territory/discord-flex-routing-diagram.jpg" alt="مخطط توجيه الرسائل."/>

*مخطط توجيه الرسائل.*
</center>

# ملخص
في الختام، في سلسلة المدونات هذه، ناقشنا ارتفاع شعبية ديسكورد والفرصة التي يمثلها للعلامات التجارية كمنصة جديدة للتفاعل مع العملاء. لقد استعرضنا بعض الميزات الأساسية لديسكورد، لإظهار كيف يمكن للعلامة التجارية إعداد مجتمعها الخاص عبر الإنترنت، بالإضافة إلى ميزات أكثر تقدمًا تسمح للعلامات التجارية بأتمتة الإشراف ودعم العملاء على خادمها باستخدام روبوتات ديسكورد. أخيرًا، شاركنا عرضنا التوضيحي لكيفية دمجنا لديسكورد مع منصة خدمة العملاء الخاصة بنا، SeaX، لتقديم ميزات متقدمة لمجتمع ديسكورد، مثل تحويل الوكيل المباشر، وإدارة الحالات، والبحث في قاعدة المعرفة المدعومة بالذكاء الاصطناعي.
للحصول على عرض توضيحي شخصي، أو لمعرفة كيف يمكن لـ Seasalt.ai المساعدة في تلبية احتياجات عملك المحددة، يرجى ملء نموذج "[حجز عرض توضيحي](https://meetings.hubspot.com/seasalt-ai/seasalt-meeting)". لمزيد من المعلومات حول تكامل فليكس/ديسكورد أو للاتصال بنا، يرجى زيارة [قائمة شركاء تويليو الخاصة بـ Seasalt.ai](https://showcase.twilio.com/partner-listing/a8E8Z000000PDCQUA4).